<!DOCTYPE html>
<html>
<script src="https://d3js.org/d3.v4.min.js"></script>
<script src="https://d3js.org/topojson.v1.js"></script>

<!--
    py -m http.server 8000 --bind 127.0.0.1
-->

<head>

    <meta charset="utf-8">
    
    <title>Visualizing the Massachusetts Affordable Housing Crisis</title>
    <style>
        body {
            font-family: Verdana, Geneva, Tahoma, sans-serif;
            font-size:100%;
        }
        h1 {
            font-size: 2em;
            color:#325f75;
            font-weight: 100;
            margin:auto;
            margin-top:20px;
            width: 75%;
        }
        h2 {
            font-size: 1.2em;
            color: #518096;
            font-weight: 800;
            margin:auto;
            margin-top:15px;
            width: 90%;
        }
        h3 {
            font-size: 1em;
            color: #518096;
            font-weight: 100;
            margin:auto;
            margin-top:5px;
            width: 15%;
        }
        p {
            color: #1b1b1b;
            margin:auto;
            margin-top:20px;
            margin-bottom:10px;
            width: 90%;
        }

    </style>

    <style type="text/css">
        #map {
        width: 615px;
        height: 375px;
        }
        
    </style>

</head>

<body>

    <h1>Visualizing the Massachusetts Affordable Housing Crisis</h1><br>
    <h3>Samantha Crepeau</h3>
    <p>
        According to the National Low Income Housing Coalition (NLIHC), the United States needs 6.8 million more affordable housing 
        units for extremely low income (ELI) families. Affordable housing is housing that consumes less than 30% of a household's 
        total income. In the United States, there is no state or county where a full-time minimum wage employee can afford to rent a 
        two-bedroom apartment [1]. In Massachusetts, as of 2019, the average resident would need an hourly wage of $33.81
        to afford a two-bedroom apartment [2]. Massachusetts faces a shortage of affordable and available rental housing for
        extremely low income households. For those who are faced with high housing costs relative to their income, other stresses 
        such as food security, health care, retirement cause increased financial strain [3]. Below, we use data visualizations
        to illustrate the severity of the affordable housing crisis in Massachusetts, how it affects people, and which groups are 
        disproportionately affected. 
    </p><br>

    <h2>What is the affordable housing crisis?</h2>
    <p>
        As stated, there is a shortage of affordable and available rental housing in Massachusetts. However, the affordable housing
        crisis does not only affect renters. According to data provided by the Federal Reserve Bank of St.Louis, the median listing
        price of houses in Massachusetts as of March 2022 was $699,450. The latest data from the US Census Bureau shows that the real 
        median household income in MA is $86,725 as of 2020 [4]. As shown in the graph below, this value has remained fairly stagnant
        compared to the median listing price in MA, which has skyrocketed since 2016. These values emphasize the sitation that MA 
        residents face upon looking to take steps toward homeownership.
    </p>
    <div id="vis1"></div><br>

    <h2>How does the affordable housing crisis affect people across MA?</h2>
    <p>In 2016, 79% of ELI renter households in Massachusetts were rent burdened, meaning that 30% or more of household income 
        went toward paying rent. Housing cost burdened households are often pushed toward sacrificing necessities such as health care 
        and food, or else risk eviction or homelessness [5]. The map below shows which towns have the highest percentage of renter
        households that are ELI in MA. Mouse over the map in order to view the town names and the corresponding percentage of ELI renter 
        households. 
    </p>
    <div id="map"></div><br>
    <!-- Map based on https://gist.github.com/michaschwab/411cbbd398e9b74e297f4aecf0410f70 -->
    <script src="add_map.js"></script> 

    <h2>Who is most affected?</h2>
    <p>
        The affordable housing crisis does not affect everyone equally - certain groups are disproportionately impacted. Racial and ethnic 
        minorities have historically been discouraged from purchasing houses [6]. There is a long history of housing discrimination in the 
        United States, notably against Black Americans, and Massachusetts is not exempt from this history. The effects of housing discrimination 
        in Massachusetts are still felt today [7]. The chart below illustrates the homeownership racial disparity in Massachusetts as of 
        2019, with data from the US Census Bureau. Mouse over the bars to view the exact percentage.
    </p>
    <div id="vis2"></div><br>

    <h2>The future</h2>
    <p>When homeownership is unattainable and renting becomes severely burdensome, it begs the question of what the average person's 
        future looks like in terms of their living situation. Will there be generations of perpetual renters spending significant
        portions of their income on rent with the dream of owning a house out of reach? It's impossible to forecast exactly what the 
        situation will look like years from now, but what we can be sure of is that the affordable housing crisis affects much of the 
        population, some groups more than others. It's imperative that we consider this crisis, its causes and effects, who suffers 
        and who benefits from it, in order to improve the quality of life for all. 
    </p>
    <br>

    <h2>References</h2>
    <p>[1] https://nlihc.org/explore-issues/why-we-care/problem</p>
    <p>[2] https://www.masslive.com/boston/2019/06/on-average-massachusetts-residents-need-to-make-3381-an-hour-to-afford-fair-market-rent-report-says.html</p>
    <p>[3] https://www.forbes.com/sites/forbesnonprofitcouncil/2021/09/07/there-is-no-easy-fix-for-the-affordable-housing-crisis/?sh=577b0bc773b7</p>
    <p>[4] https://fred.stlouisfed.org/graph/?id=MEDLISPRIMA,MEHOINUSMAA672N</p>
    <p>[5] https://www.bostonfed.org/publications/new-england-public-policy-center-policy-report/2019/growing-shortage-affordable-housing-extremely-low-income-massachusetts.aspx</p>
    <p>[6] https://www.americashealthrankings.org/explore/annual/measure/homeownership_disparity/state/MA</p>
    <p>[7] https://www.masslive.com/boston/2020/07/study-shows-high-level-of-housing-discrimination-against-black-renters-people-with-section-8-vouchers-in-greater-boston.html</p>
    

</body>

<style>

    #vis1 {
        margin: auto;
        width: 60%;
        margin-top: 10px;
    }

    #map {
        margin: auto;
        width: 55%;
        margin-top: 30px;
    }

    #vis2 {
        margin: auto;
        width: 70%;
        margin-top: 10px;
    }

    .barToolTip {
        position: absolute;
        display: none;
        min-width: 80px;
        height: auto;
        background: none repeat scroll 0 0 #ffffff;
        border: 1px solid #414141;
        padding: 14px;
        text-align: center;
        }

</style>

<script>

    // *** VIS 1 *** // https://d3-graph-gallery.com/graph/line_basic.html

    var margin = {top: 10, right: 30, bottom: 30, left: 60},
        width = 600 - margin.left - margin.right,
        height = 300 - margin.top - margin.bottom;

    var svg1 = d3.select("#vis1")
        .append("svg")
            .attr("width", width + margin.left + margin.right)
            .attr("height", height + margin.top + margin.bottom)
        .append("g")
            .attr("transform",
                "translate(" + margin.left + "," + margin.top + ")");

    d3.csv("data/listprice_houseincome.csv",

        function(d){
            return { date : d3.timeParse("%Y-%m-%d")(d.DATE), price : d.MEDLISPRI, income : d.MEHOIN } 
        },

        function(data) {

            // X AXIS
            var x = d3.scaleTime()
                .domain(d3.extent(data, function(d) {return d.date; }))
                .range([0, width]);
            svg1.append("g")
                .attr("transform", "translate(0," + height + ")")
                .call(d3.axisBottom(x));
            svg1.append("text")
                .attr("class", "x label")
                .attr("text-anchor", "end")
                .attr("x", width)
                .attr("y", height - 6)
                .attr("font-size", 12)
                .text("Year");

            // Y AXIS
            var y = d3.scaleLinear()
                .domain([0, d3.max(data, function(d) { return +(d.price); })])
                .range([height, 0]);
            svg1.append("g")
                .call(d3.axisLeft(y));
            svg1.append("text")
                .attr("class", "y label")
                .attr("text-anchor", "end")
                .attr("y", 6)
                .attr("dy", ".75em")
                .attr("transform", "rotate(-90)")
                .attr("font-size", 12)
                .text("Amount in $");

            // LINES
            svg1.append("path")
                .datum(data)
                .attr("fill", "none")
                .attr("stroke", "red")
                .attr("stroke-width", 1.5)
                .attr("d", d3.line()
                    .x(function(d) { return x(d.date) })
                    .y(function(d) { return y(d.price) })
                )
            svg1.append("path")
                .datum(data)
                .attr("fill", "none")
                .attr("stroke", "teal")
                .attr("stroke-width", 1.5)
                .attr("d", d3.line()
                    .x(function(d) { return x(d.date) })
                    .y(function(d) { return y(d.income) })
                )

            // LEGEND
            svg1.append("circle").attr("cx",width-150).attr("cy",height-100).attr("r", 5).style("fill", "red")
            svg1.append("circle").attr("cx",width-150).attr("cy",height-80).attr("r", 5).style("fill", "teal")
            svg1.append("text").attr("x", width-140).attr("y",height-100).text("Median Listing Price in MA").style("font-size", "9px").attr("alignment-baseline","middle")
            svg1.append("text").attr("x", width-140).attr("y",height-80).text("Real Median Household Income in MA").style("font-size", "9px").attr("alignment-baseline","middle")

        }

    )

    // *** VIS 2 *** // https://d3-graph-gallery.com/graph/barplot_horizontal.html

    var margin2 = {top: 30, right: 30, bottom: 40, left: 140},
        width2 = 600 - margin.left - margin.right,
        height2 = 400 - margin.top - margin.bottom;

    var svg2 = d3.select("#vis2")
        .append("svg")
            .attr("width", width2 + margin2.left + margin2.right)
            .attr("height", height2 + margin2.top + margin2.bottom)
        .append("g")
            .attr("transform",
                "translate(" + margin2.left + "," + margin2.top + ")");

    var bartooltip = d3.select("body").append("div").attr("class", "barToolTip");

    d3.csv("data/homeowner_dis.csv", function(data) {

        // X AXIS
        var x2 = d3.scaleLinear()
            .domain([0,100])
            .range([0, width2]);
        svg2.append("g")
            .attr("transform", "translate(0," + height2 + ")")
            .call(d3.axisBottom(x2))
            .selectAll("text")
                .attr("transform", "translate(-10,0)rotate(-45)")
                .style("text-anchor", "end");
        
        // TITLE
        svg2.append("text")
            .attr("x", (width2 / 2))             
            .attr("y", 0 - (margin2.top / 2))
            .attr("text-anchor", "middle")  
            .style("font-size", "16px") 
            .text("Homeownership Racial Disparity in MA");

        // Y AXIS
        var y2 = d3.scaleBand()
            .range([0, height2])
            .domain(data.map(function(d) { return d.RACE; }))
            .padding(.1);
        svg2.append("g")
            .call(d3.axisLeft(y2))

        // BARS
        svg2.selectAll(".bar")
            .data(data)
            .enter()
            .append("rect")
            .attr("class", "bar")
            .attr("x", x2(0))
            .attr("y", function(d) { return y2(d.RACE); })
            .attr("width", function(d) { return x2(d.PERCENT); })
            .attr("height", y2.bandwidth())
            .attr("fill", "#69b3a2")
            .on("mousemove", function(d){
                bartooltip
                .style("left", d3.event.pageX - 50 + "px")
                .style("top", d3.event.pageY - 70 + "px")
                .style("display", "inline-block")
                .html("Homeownership: " + (d.PERCENT) + "%");
            })
            .on("mouseout", function(d){ bartooltip.style("display", "none");});

    })

</script>

</html>